# Migration Data Restoration Procedures

## Backup Information
- **Backup ID**: migration-2025-08-13T11-26-18-516Z
- **Created**: 2025-08-13T11:26:18.517Z
- **Git Commit**: bdba425805fbd6f632b3db03725c49afb3f2753a
- **Git Branch**: develop
- **Total Files**: 0
- **Total Size**: 0.00 MB

## Emergency Rollback Procedures

### 1. Full System Rollback

```bash
# EMERGENCY USE ONLY - Restores entire system to backup state
cd /path/to/lookcoin-contract

# Stop any running processes
pkill -f "tsx"

# Backup current state (in case rollback needs reversal)
mv deployments deployments.pre-rollback
mv leveldb leveldb.pre-rollback
mv scripts scripts.pre-rollback

# Restore from backup
cp -r backups/migration-2025-08-13T11-26-18-516Z/leveldb/current leveldb
cp -r backups/migration-2025-08-13T11-26-18-516Z/legacy-json/* deployments/
cp -r backups/migration-2025-08-13T11-26-18-516Z/unified-json/unified deployments/
cp -r backups/migration-2025-08-13T11-26-18-516Z/scripts/* scripts/

# Restore configurations
cp backups/migration-2025-08-13T11-26-18-516Z/configs/hardhat.config.ts .
cp backups/migration-2025-08-13T11-26-18-516Z/configs/package.json .
cp backups/migration-2025-08-13T11-26-18-516Z/configs/tsconfig.json .

# Verify integrity
npm run backup:verify-restore
```

### 2. Selective Restoration

#### LevelDB Data Only
```bash
# Stop processes using LevelDB
pkill -f "tsx"

# Backup current LevelDB
mv leveldb leveldb.backup-$(date +%Y%m%d-%H%M%S)

# Restore LevelDB
cp -r backups/migration-2025-08-13T11-26-18-516Z/leveldb/current leveldb

# Restart services
npm run dev
```

#### Legacy JSON Files Only
```bash
# Backup current deployments
cp -r deployments deployments.backup-$(date +%Y%m%d-%H%M%S)

# Restore legacy JSON files
cp backups/migration-2025-08-13T11-26-18-516Z/legacy-json/*.json deployments/

# Verify deployment integrity
npm run validate-enhanced-schema
```

#### Unified JSON Files Only
```bash
# Backup current unified files
cp -r deployments/unified deployments/unified.backup-$(date +%Y%m%d-%H%M%S)

# Restore unified files
rm -rf deployments/unified
cp -r backups/migration-2025-08-13T11-26-18-516Z/unified-json/unified deployments/

# Validate unified schema
npm run test:integration
```

### 3. Integrity Verification

```bash
# Verify backup integrity before restoration
cd backups/migration-2025-08-13T11-26-18-516Z
sha256sum -c checksums/SHA256SUMS

# Verify specific category
sha256sum -c checksums/SHA256SUMS | grep "leveldb\|legacy-json\|unified-json"
```

## Post-Restoration Steps

1. **Verify Node Dependencies**
   ```bash
   npm install
   npm run compile
   ```

2. **Validate Data Integrity**
   ```bash
   npm run validate-cross-network-integrity
   npm run compare-leveldb-to-unified
   ```

3. **Run Integration Tests**
   ```bash
   npm test
   npm run test:integration
   ```

4. **Check Service Health**
   ```bash
   npm run dev
   # Verify services start without errors
   ```

## Troubleshooting

### Permission Issues
```bash
# Fix file permissions if needed
chmod -R 755 leveldb/
chmod -R 644 deployments/*.json
chmod +x scripts/*.ts
```

### Checksum Failures
```bash
# If checksums fail, inspect specific files
cd backups/migration-2025-08-13T11-26-18-516Z
sha256sum checksums/SHA256SUMS | grep FAIL

# Compare with original if available
diff -r backups/migration-2025-08-13T11-26-18-516Z/leveldb/current leveldb/
```

### Partial Restoration
If full restoration fails:
1. Restore categories one by one
2. Test each category after restoration  
3. Use git to track changes during restoration
4. Consult backup manifest for file inventory

## Emergency Contacts

- **DevOps Team**: [Contact Information]
- **Migration Lead**: [Contact Information]
- **System Administrator**: [Contact Information]

## Backup Manifest Location
`backups/migration-2025-08-13T11-26-18-516Z/BACKUP_MANIFEST.json`

---
*Generated by Enterprise Migration Backup System v1.0.0*
*Backup Created: 2025-08-13T11:26:18.517Z*
